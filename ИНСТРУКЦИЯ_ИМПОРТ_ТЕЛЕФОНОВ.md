# –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –∏–º–ø–æ—Ä—Ç—É —Ç–µ–ª–µ—Ñ–æ–Ω–æ–≤ –∏–∑ kliriki.xlsx

## –û–ø–∏—Å–∞–Ω–∏–µ

–≠—Ç–∞ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –æ–ø–∏—Å—ã–≤–∞–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–º–µ—Ä–æ–≤ —Ç–µ–ª–µ—Ñ–æ–Ω–æ–≤ –¥–ª—è —Å–≤—è—â–µ–Ω–Ω–∏–∫–æ–≤ –∏ –¥–∏–∞–∫–æ–Ω–æ–≤ –∏–∑ —Ñ–∞–π–ª–∞ `kliriki.xlsx`.

## –§–∞–π–ª—ã

1. **`kliriki_parser.py`** - –ü–∞—Ä—Å–µ—Ä –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –§–ò–û –∏ —Ç–µ–ª–µ—Ñ–æ–Ω–æ–≤ –∏–∑ —Ñ–∞–π–ª–∞
2. **`import_phones_from_kliriki.py`** - –°–∫—Ä–∏–ø—Ç –∏–º–ø–æ—Ä—Ç–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–æ–≤ –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
3. **`test_kliriki_read.py`** - –¢–µ—Å—Ç–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —á—Ç–µ–Ω–∏—è —Ñ–∞–π–ª–∞
4. **`data/kliriki.xlsx`** - –ò—Å—Ö–æ–¥–Ω—ã–π —Ñ–∞–π–ª —Å —Ç–µ–ª–µ—Ñ–æ–Ω–∞–º–∏

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ kliriki.xlsx

- **–ö–æ–ª–æ–Ω–∫–∞ D (4-—è)**: –ü–æ–ª–æ–∂–µ–Ω–∏–µ ("–ù–∞—Å—Ç–æ—è—Ç–µ–ª—å"), —Å–∞–Ω (–ø—Ä–æ—Ç–æ–∏–µ—Ä–µ–π, –∏–µ—Ä–µ–π –∏ —Ç.–¥.), –∏–º—è, –æ—Ç—á–µ—Å—Ç–≤–æ, —Ñ–∞–º–∏–ª–∏—è
  - –§–∞–º–∏–ª–∏—è –º–æ–∂–µ—Ç –ø–µ—Ä–µ–Ω–æ—Å–∏—Ç—å—Å—è –Ω–∞ –Ω–æ–≤—É—é —Å—Ç—Ä–æ–∫—É
  - –ú–æ–∂–µ—Ç –±—ã—Ç—å —Ç–µ–∫—Å—Ç "–æ–±—Å–ª—É–∂–∏–≤–∞–µ—Ç—Å—è –∫–ª–∏—Ä–∏–∫–∞–º–∏..." (–ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç—Å—è)
- **–ö–æ–ª–æ–Ω–∫–∞ E (5-—è)**: –ù–æ–º–µ—Ä–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–æ–≤

## –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∫–æ–¥–µ

### 1. models.py
- –î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–ª–µ `phone: str = ""` –≤ –∫–ª–∞—Å—Å `Priest`
- –û–±–Ω–æ–≤–ª–µ–Ω—ã –º–µ—Ç–æ–¥—ã `to_dict()` –∏ `format_message()`

### 2. database.py
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –∫–æ–ª–æ–Ω–∫–∞ `phone TEXT` –≤ —Ç–∞–±–ª–∏—Ü—É `priests`
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –º–∏–≥—Ä–∞—Ü–∏—è –¥–ª—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö
- –û–±–Ω–æ–≤–ª–µ–Ω—ã –º–µ—Ç–æ–¥—ã `add_priest()`, `update_priest()`, `_row_to_priest()`

### 3. kliriki_parser.py (–Ω–æ–≤—ã–π —Ñ–∞–π–ª)
- –ö–ª–∞—Å—Å `KlirikiParser` –¥–ª—è –ø–∞—Ä—Å–∏–Ω–≥–∞ —Ñ–∞–π–ª–∞
- –ú–µ—Ç–æ–¥—ã:
  - `parse_fio_from_column_d()` - –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –§–ò–û
  - `parse_phone_from_column_e()` - –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ —Ç–µ–ª–µ—Ñ–æ–Ω–∞
  - `extract_all_entries()` - –ø–æ–ª—É—á–µ–Ω–∏–µ –≤—Å–µ—Ö –∑–∞–ø–∏—Å–µ–π

### 4. import_phones_from_kliriki.py (–Ω–æ–≤—ã–π —Ñ–∞–π–ª)
- –°–∫—Ä–∏–ø—Ç –¥–ª—è –∏–º–ø–æ—Ä—Ç–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–æ–≤
- –°–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –ø–æ –§–ò–û (–Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–º—É)
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ç–æ—á–Ω–æ–≥–æ –∏ —á–∞—Å—Ç–∏—á–Ω–æ–≥–æ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è

## –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—é

### –õ–æ–∫–∞–ª—å–Ω–æ (—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ)

```bash
cd /Users/valentin/Cancellary_Bot

# –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ
source venv/bin/activate

# –¢–µ—Å—Ç —á—Ç–µ–Ω–∏—è —Ñ–∞–π–ª–∞
python3 test_kliriki_read.py

# –ò–º–ø–æ—Ä—Ç —Ç–µ–ª–µ—Ñ–æ–Ω–æ–≤
python3 import_phones_from_kliriki.py
```

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ**: –ù–∞ macOS –º–æ–≥—É—Ç –≤–æ–∑–Ω–∏–∫–∞—Ç—å –ø—Ä–æ–±–ª–µ–º—ã —Å —á—Ç–µ–Ω–∏–µ–º Excel —Ñ–∞–π–ª–æ–≤ (exit code 139). –í —ç—Ç–æ–º —Å–ª—É—á–∞–µ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç–µ –∫ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—é –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ.

### –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ (Oracle Linux)

#### –®–∞–≥ 1: –ö–æ–º–º–∏—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π

```bash
cd /Users/valentin/Cancellary_Bot

# –î–æ–±–∞–≤–∏—Ç—å –≤—Å–µ –Ω–æ–≤—ã–µ —Ñ–∞–π–ª—ã
git add models.py database.py kliriki_parser.py import_phones_from_kliriki.py test_kliriki_read.py data/kliriki.xlsx –ò–ù–°–¢–†–£–ö–¶–ò–Ø_–ò–ú–ü–û–†–¢_–¢–ï–õ–ï–§–û–ù–û–í.md

# –°–æ–∑–¥–∞—Ç—å –∫–æ–º–º–∏—Ç
git commit -m "–î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–æ–≤: –ø–∞—Ä—Å–∏–Ω–≥ kliriki.xlsx –∏ –∏–º–ø–æ—Ä—Ç –≤ –ë–î"

# –û—Ç–ø—Ä–∞–≤–∏—Ç—å –Ω–∞ GitHub
git push origin main
```

#### –®–∞–≥ 2: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

```bash
# –ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É
ssh -i ~/.ssh/–≤–∞—à_–∫–ª—é—á.key opc@–ü–£–ë–õ–ò–ß–ù–´–ô_IP

# –ü–µ—Ä–µ–π—Ç–∏ –≤ –ø–∞–ø–∫—É –ø—Ä–æ–µ–∫—Ç–∞
cd /home/opc/telegram-bot

# –ü–æ–ª—É—á–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è
git pull origin main

# –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ
source venv/bin/activate

# –¢–µ—Å—Ç —á—Ç–µ–Ω–∏—è —Ñ–∞–π–ª–∞
python3 test_kliriki_read.py

# –ò–º–ø–æ—Ä—Ç —Ç–µ–ª–µ—Ñ–æ–Ω–æ–≤
python3 import_phones_from_kliriki.py
```

#### –®–∞–≥ 3: –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ /opt –∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ –±–æ—Ç–∞

```bash
# –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
sudo rsync -av --exclude='venv' --exclude='.git' --exclude='__pycache__' \
  /home/opc/telegram-bot/ /opt/telegram-bot/

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç–∞
sudo systemctl restart telegram-bot

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å
sudo systemctl status telegram-bot

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏
sudo journalctl -u telegram-bot -f
```

## –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –∏–º–ø–æ—Ä—Ç–∞:

1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞ –≤ Telegram
2. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–Ω–æ–ø–∫—É **üìã –°–ø–∏—Å–æ–∫** - —Ç–µ–ª–µ—Ñ–æ–Ω—ã –¥–æ–ª–∂–Ω—ã –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è
3. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ **üîç –ü–æ–∏—Å–∫** - –Ω–∞–π–¥–∏—Ç–µ —Å–≤—è—â–µ–Ω–Ω–∏–∫–∞ –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞–ª–∏—á–∏–µ —Ç–µ–ª–µ—Ñ–æ–Ω–∞
4. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ **üéâ –ò–º–µ–Ω–∏–Ω–Ω–∏–∫–∏** - —Ç–µ–ª–µ—Ñ–æ–Ω—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤ –æ—Ç—á–µ—Ç–∞—Ö

## –§–æ—Ä–º–∞—Ç –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ç–µ–ª–µ—Ñ–æ–Ω–∞

–í —Å–æ–æ–±—â–µ–Ω–∏—è—Ö –±–æ—Ç–∞ —Ç–µ–ª–µ—Ñ–æ–Ω –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è —Ç–∞–∫:

```
üìû –¢–µ–ª–µ—Ñ–æ–Ω: +380501234567
```

## –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –ü—Ä–æ–±–ª–µ–º–∞: "Exit code: 139" –ø—Ä–∏ —á—Ç–µ–Ω–∏–∏ —Ñ–∞–π–ª–∞

**–†–µ—à–µ–Ω–∏–µ**: –≠—Ç–æ –ø—Ä–æ–±–ª–µ–º–∞ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ pandas/openpyxl –Ω–∞ macOS. –í—ã–ø–æ–ª–Ω–∏—Ç–µ –∏–º–ø–æ—Ä—Ç –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ Oracle Linux.

### –ü—Ä–æ–±–ª–µ–º–∞: "ModuleNotFoundError: No module named 'openpyxl'"

**–†–µ—à–µ–Ω–∏–µ**:
```bash
source venv/bin/activate
pip install -r requirements.txt
```

### –ü—Ä–æ–±–ª–µ–º–∞: "–§–∞–π–ª kliriki.xlsx –Ω–µ –Ω–∞–π–¥–µ–Ω"

**–†–µ—à–µ–Ω–∏–µ**: –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ñ–∞–π–ª –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –ø–∞–ø–∫–µ `data/`:
```bash
ls -la data/kliriki.xlsx
```

### –ü—Ä–æ–±–ª–µ–º–∞: –ú–Ω–æ–≥–æ –∑–∞–ø–∏—Å–µ–π "–ù–µ –Ω–∞–π–¥–µ–Ω–æ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π"

**–ü—Ä–∏—á–∏–Ω—ã**:
- –§–ò–û –≤ kliriki.xlsx –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è –æ—Ç –§–ò–û –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
- –û–ø–µ—á–∞—Ç–∫–∏ –∏–ª–∏ —Ä–∞–∑–Ω–æ–µ –Ω–∞–ø–∏—Å–∞–Ω–∏–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, "–ò–≤–∞–Ω" vs "–ò–æ–∞–Ω–Ω")

**–†–µ—à–µ–Ω–∏–µ**: –ü—Ä–æ—Å–º–æ—Ç—Ä–∏—Ç–µ —Å–ø–∏—Å–æ–∫ –Ω–µ—Å–æ–≤–ø–∞–¥–µ–Ω–∏–π –∏ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –æ–±–Ω–æ–≤–∏—Ç–µ –≤—Ä—É—á–Ω—É—é —á–µ—Ä–µ–∑ SQL –∏–ª–∏ –∫–æ–¥.

## –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏–º–ø–æ—Ä—Ç–∞

–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Å–∫—Ä–∏–ø—Ç–∞ –≤—ã —É–≤–∏–¥–∏—Ç–µ:

```
üìä –°–¢–ê–¢–ò–°–¢–ò–ö–ê –ò–ú–ü–û–†–¢–ê
====================================================================
–í—Å–µ–≥–æ –∑–∞–ø–∏—Å–µ–π –≤ kliriki.xlsx: 150
–ù–∞–π–¥–µ–Ω–æ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π —Å –ë–î: 140
–û–±–Ω–æ–≤–ª–µ–Ω–æ —Ç–µ–ª–µ—Ñ–æ–Ω–æ–≤: 138
–ù–µ –Ω–∞–π–¥–µ–Ω–æ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π: 10
```

## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

- –¢–µ–ª–µ—Ñ–æ–Ω—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –ø–æ–ª–µ `phone` —Ç–∞–±–ª–∏—Ü—ã `priests`
- –°–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø–æ –ø–æ–ª–Ω–æ–º—É –§–ò–û (—Ñ–∞–º–∏–ª–∏—è + –∏–º—è + –æ—Ç—á–µ—Å—Ç–≤–æ)
- –ü—Ä–∏ —á–∞—Å—Ç–∏—á–Ω–æ–º —Å–æ–≤–ø–∞–¥–µ–Ω–∏–∏ (—Ñ–∞–º–∏–ª–∏—è + –∏–º—è) –∑–∞–ø–∏—Å—å —Ç–∞–∫–∂–µ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è
- –ü—É—Å—Ç—ã–µ —Ç–µ–ª–µ—Ñ–æ–Ω—ã –Ω–µ –æ–±–Ω–æ–≤–ª—è—é—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è
